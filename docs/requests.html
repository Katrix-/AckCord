<html><head><title>AckCord: Making Requests</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Katrix" /><meta name="description" content="A Scala Discord library" /><meta name="og:image" content="/img/poster.png" /><meta name="og:title" content="AckCord: Making Requests" /><meta name="og:site_name" content="AckCord" /><meta name="og:url" content="http://ackcord.katsstuff.net" /><meta name="og:type" content="website" /><meta name="og:description" content="A Scala Discord library" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="AckCord: Making Requests" /><meta name="twitter:image" content="http://ackcord.katsstuff.netimg/poster.png" /><meta name="twitter:description" content="A Scala Discord library" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/default.css" /><link rel="stylesheet" href="/css/style.css" /><link rel="stylesheet" href="/css/palette.css" /><link rel="stylesheet" href="/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>AckCord</span></div></a></li> <li><a href="/getting_started.html" class="">Getting Started</a></li> <li><a href="/docs/cachesnapshot.html" class="">Shared concepts</a> <ul class="sub_section"> <li><a href="/docs/cachesnapshot.html" class="">CacheSnapshot</a></li> <li><a href="/docs/sharedcommands.html" class="">Shared command concepts</a></li></ul></li> <li><a href="/docs/requests.html" class=" active ">Making Requests</a></li> <li><a href="/docs/cache.html" class="">The cache (Advanced)</a></li> <li><a href="/docs/sound.html" class="">Sending custom sound (Advanced)</a></li> <li><a href="/docs/hicommands.html" class="">High level API commands</a></li> <li><a href="/docs/locommands.html" class="">Low level API commands</a></li> <li><a href="/modules.html" class="">The many modules of AckCord</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/Katrix-/AckCord"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/Katrix-/AckCord"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="Katrix-" data-github-repo="AckCord"><div class="content-wrapper"><section><h1 id="making-requests">Making Requests</h1>
<p>What use is a Discord library if you canâ€™t make REST requests? There are two parts to this, creating a request, and running it. Both have many ways to do things.</p>

<h2 id="creating-a-request">Creating a request</h2>
<p>First we need a request object to send. There are two main ways to get such a request object. The first one is to create <code class="highlighter-rouge">Request</code> objects with requests from the <code class="highlighter-rouge">http.rest</code> and <code class="highlighter-rouge">http.images</code> packages manually. The second is to import <code class="highlighter-rouge">net.katsstuff.ackcord.syntax._</code> and use the extensions methods provided by that. If you use the low level API, you can also specify a context object as part of the request, which you get back from the response. If you need some sort of order from your request, you use this, as requests are sent and received in any order.</p>

<h2 id="running-the-request">Running the request</h2>
<p>To run requests you would either use a <code class="highlighter-rouge">RequestHelper</code>, or a <code class="highlighter-rouge">RequestDSL</code> object.</p>

<p><code class="highlighter-rouge">RequestHelper</code> is normally used in low level API where you want to model your behavior as a stream. Here you represent your requests as a <code class="highlighter-rouge">Source</code>, and the act of sending them as a <code class="highlighter-rouge">Flow</code> found in <code class="highlighter-rouge">RequestHelper</code>. You have to create the <code class="highlighter-rouge">RequestHelper</code> yourself.</p>

<p><code class="highlighter-rouge">RequestDSL</code> while more limited than <code class="highlighter-rouge">RequestHelper</code> allows you to model your behavior as a sequence of requests using monadic operations. When using <code class="highlighter-rouge">RequestDSL</code>, you also need something to run it. Either you have to run it yourself using a <code class="highlighter-rouge">Flow</code> gotten from <code class="highlighter-rouge">RequestHelper</code>, or some methods can run it for you. For the high level API, all methods that have DSL in their name expects a <code class="highlighter-rouge">RequestDSL</code>, and will run it when needed.</p>

<h2 id="example">Example</h2>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">net.katsstuff.ackcord._</span>
<span class="k">import</span> <span class="nn">net.katsstuff.ackcord._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">net.katsstuff.ackcord.data._</span>
<span class="k">import</span> <span class="nn">net.katsstuff.ackcord.data._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">net.katsstuff.ackcord.syntax._</span>
<span class="k">import</span> <span class="nn">net.katsstuff.ackcord.syntax._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">net.katsstuff.ackcord.http.rest.CreateMessage</span>
<span class="k">import</span> <span class="nn">net.katsstuff.ackcord.http.rest.CreateMessage</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">token</span> <span class="k">=</span> <span class="s">"&lt;token&gt;"</span>
<span class="n">token</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">token</span><span class="o">&gt;</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">settings</span> <span class="k">=</span> <span class="nc">ClientSettings</span><span class="o">(</span><span class="n">token</span><span class="o">)</span>
<span class="n">settings</span><span class="k">:</span> <span class="kt">net.katsstuff.ackcord.ClientSettings</span> <span class="o">=</span> <span class="nc">GatewaySettings</span><span class="o">(&lt;</span><span class="n">token</span><span class="o">&gt;,</span><span class="mi">100</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="nc">None</span><span class="o">,</span><span class="nc">None</span><span class="o">,</span><span class="nc">Online</span><span class="o">,</span><span class="kc">false</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">settings.executionContext</span>
<span class="k">import</span> <span class="nn">settings.executionContext</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">futureClient</span> <span class="k">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">build</span><span class="o">()</span>
<span class="n">futureClient</span><span class="k">:</span> <span class="kt">scala.concurrent.Future</span><span class="o">[</span><span class="kt">net.katsstuff.ackcord.DiscordClient</span><span class="o">[</span><span class="kt">cats.Id</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Future</span><span class="o">(&lt;</span><span class="n">not</span> <span class="n">completed</span><span class="o">&gt;)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
     <span class="o">|</span>   <span class="n">client</span><span class="o">.</span><span class="n">onEventDSLC</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">c</span> <span class="k">=&gt;</span> <span class="o">{</span>
     <span class="o">|</span>     <span class="k">case</span> <span class="nc">APIMessage</span><span class="o">.</span><span class="nc">ChannelCreate</span><span class="o">(</span><span class="n">channel</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
     <span class="o">|</span>       <span class="k">import</span> <span class="nn">RequestDSL._</span>
     <span class="o">|</span>       <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>         <span class="c1">//optionPure lifts an Option into the dsl
</span>     <span class="o">|</span>         <span class="n">guildChannel</span> <span class="k">&lt;-</span> <span class="n">optionPure</span><span class="o">(</span><span class="n">channel</span><span class="o">.</span><span class="n">asGuildChannel</span><span class="o">)</span>
     <span class="o">|</span>         <span class="c1">//liftOptionT lifts an OptionT into the dsl
</span>     <span class="o">|</span>         <span class="n">guild</span>        <span class="k">&lt;-</span> <span class="n">liftOptionT</span><span class="o">(</span><span class="n">guildChannel</span><span class="o">.</span><span class="n">guild</span><span class="o">)</span>
     <span class="o">|</span>         <span class="c1">//optionRequest lifts an optional request into the dsl. Normal requests don't need to be lifted
</span>     <span class="o">|</span>         <span class="n">msg</span>          <span class="k">&lt;-</span> <span class="n">optionRequest</span><span class="o">(</span><span class="n">guild</span><span class="o">.</span><span class="n">tChannels</span><span class="o">.</span><span class="n">headOption</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">sendMessage</span><span class="o">(</span><span class="n">s</span><span class="s">"${guildChannel.name} was deleted"</span><span class="o">)))</span>
     <span class="o">|</span>         <span class="c1">//Creating a request without using the extra syntax
</span>     <span class="o">|</span>         <span class="k">_</span>            <span class="k">&lt;-</span> <span class="nc">CreateMessage</span><span class="o">.</span><span class="n">mkContent</span><span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="n">channelId</span><span class="o">,</span> <span class="s">"Another message"</span><span class="o">)</span>
     <span class="o">|</span>       <span class="o">}</span> <span class="k">yield</span> <span class="o">()</span>
     <span class="o">|</span>     <span class="o">}</span>
     <span class="o">|</span>   <span class="o">}</span>
     <span class="o">|</span>   
     <span class="o">|</span>   <span class="c1">//client.login()
</span>     <span class="o">|</span> <span class="o">}</span>
</code></pre></div></div>

<h2 id="access-to-the-low-level-api">Access to the low level API</h2>
<p>Accessing the low level API from the high level API is as simple as getting the <code class="highlighter-rouge">RequestHelper</code> instance that is backing the <code class="highlighter-rouge">DiscordClient[F]</code> instance is as simple as calling the <code class="highlighter-rouge">requests</code> method on a <code class="highlighter-rouge">DiscordClient[F]</code>.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
     <span class="o">|</span>   <span class="k">val</span> <span class="n">requests</span><span class="k">:</span> <span class="kt">RequestHelper</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">requests</span>
     <span class="o">|</span> <span class="o">}</span>
</code></pre></div></div>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/js/main.js"></script></body></html>