<html><head><title>AckCord: High level API commands</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Katrix" /><meta name="description" content="A Scala Discord library" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="AckCord: High level API commands" /><meta name="title" property="og:title" content="AckCord: High level API commands" /><meta name="og:site_name" content="AckCord" /><meta name="og:url" content="http://ackcord.katsstuff.net" /><meta name="og:type" content="website" /><meta name="og:description" content="A Scala Discord library" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="AckCord: High level API commands" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="A Scala Discord library" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/default.css" /><link rel="stylesheet" href="/css/style.css" /><link rel="stylesheet" href="/css/palette.css" /><link rel="stylesheet" href="/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>AckCord</span></div></a></li> <li><a href="/getting_started.html" class="">Getting Started</a></li> <li><a href="/docs/cachesnapshot.html" class="">Shared concepts</a> <ul class="sub_section"> <li><a href="/docs/cachesnapshot.html" class="">CacheSnapshot</a></li> <li><a href="/docs/sharedcommands.html" class="">Shared command concepts</a></li></ul></li> <li><a href="/docs/requests.html" class="">Making Requests</a></li> <li><a href="/docs/cache.html" class="">The cache (Advanced)</a></li> <li><a href="/docs/sound.html" class="">Sending custom sound (Advanced)</a></li> <li><a href="/docs/hicommands.html" class=" active ">High level API commands</a></li> <li><a href="/docs/locommands.html" class="">Low level API commands</a></li> <li><a href="/docs/newcommands.html" class="">New incubating commands</a></li> <li><a href="/modules.html" class="">The many modules of AckCord</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/Katrix/AckCord"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/Katrix/AckCord"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="Katrix" data-github-repo="AckCord"><div class="content-wrapper"><section><h1 id="high-level-api-commands">High level API commands</h1>
<p>The high level AckCord API comes with built in command support. Before reading this, make sure you understand the shared command concepts.</p>

<p>In the high level API you can either just listen to the raw command events, or you can register a parsed command.</p>

<p>As before we create out client as usual, but with a small twist. This time we also pass in command settings to our client settings, which is where we specify our categories. We also import the commands package.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">akka.NotUsed</span>
<span class="k">import</span> <span class="nn">ackcord._</span>
<span class="k">import</span> <span class="nn">ackcord.data._</span>
<span class="k">import</span> <span class="nn">ackcord.syntax._</span>
<span class="k">import</span> <span class="nn">ackcord.commands._</span>
<span class="k">import</span> <span class="nn">cats.Monad</span>
<span class="k">val</span> <span class="n">token</span> <span class="k">=</span> <span class="s">"&lt;token&gt;"</span>
<span class="k">val</span> <span class="nc">GeneralCommands</span> <span class="k">=</span> <span class="s">"!"</span>
<span class="c1">// IMPORTANT: We specify needsMention = true here. This is the default option.
// If you don't want to require a mention, turn this off.
</span><span class="k">val</span> <span class="n">settings</span> <span class="k">=</span> <span class="nc">ClientSettings</span><span class="o">(</span><span class="n">token</span><span class="o">,</span> <span class="n">commandSettings</span> <span class="k">=</span> <span class="nc">CommandSettings</span><span class="o">(</span><span class="n">prefixes</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="nc">GeneralCommands</span><span class="o">),</span> <span class="n">needsMention</span> <span class="k">=</span> <span class="kc">true</span><span class="o">))</span>
<span class="k">import</span> <span class="nn">settings.executionContext</span>

<span class="k">val</span> <span class="n">futureClient</span> <span class="k">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">createClient</span><span class="o">()</span>
<span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
  <span class="c1">//client.login()
</span><span class="o">}</span>
</code></pre></div></div>

<p>When you register a parsed command, you also pass in a refiner and a description for the command.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="n">registerParsedCommand</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="kt">:</span> <span class="kt">Monad:</span> <span class="kt">Streamable</span><span class="o">](</span><span class="n">commands</span><span class="k">:</span> <span class="kt">CommandsHelper</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="n">commands</span><span class="o">.</span><span class="n">registerCmd</span><span class="o">[</span><span class="kt">NotUsed</span>, <span class="kt">Id</span><span class="o">](</span>
     <span class="o">|</span>   	<span class="n">refiner</span> <span class="k">=</span> <span class="nc">CmdInfo</span><span class="o">[</span><span class="kt">F</span><span class="o">](</span><span class="n">prefix</span> <span class="k">=</span> <span class="nc">GeneralCommands</span><span class="o">,</span> <span class="n">aliases</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"ping"</span><span class="o">),</span> <span class="n">filters</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="nc">CmdFilter</span><span class="o">.</span><span class="nc">NonBot</span><span class="o">,</span> <span class="nc">CmdFilter</span><span class="o">.</span><span class="nc">InGuild</span><span class="o">)),</span>
     <span class="o">|</span>     <span class="n">description</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">CmdDescription</span><span class="o">(</span><span class="s">"Ping"</span><span class="o">,</span> <span class="s">"Check if the bot is alive"</span><span class="o">))</span>
     <span class="o">|</span>   <span class="o">)</span> <span class="o">{</span> <span class="n">cmd</span><span class="k">:</span> <span class="kt">ParsedCmd</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">NotUsed</span><span class="o">]</span> <span class="k">=&gt;</span>
     <span class="o">|</span>     <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"Received ping command"</span><span class="o">)</span>
     <span class="o">|</span>   <span class="o">}</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">registerParsedCommand</span><span class="k">:</span> <span class="err">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="err">]</span><span class="o">(</span><span class="n">commands</span><span class="k">:</span> <span class="kt">ackcord.CommandsHelper</span><span class="o">[</span><span class="kt">F</span><span class="o">])(</span><span class="k">implicit</span> <span class="n">evidence$1</span><span class="k">:</span> <span class="kt">cats.Monad</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="k">implicit</span> <span class="n">evidence$2</span><span class="k">:</span> <span class="kt">ackcord.Streamable</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="nc">Unit</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
     <span class="o">|</span>   <span class="n">registerParsedCommand</span><span class="o">(</span><span class="n">client</span><span class="o">)</span>
     <span class="o">|</span> <span class="o">}</span>
</code></pre></div></div>

<p>Notice the type <code class="highlighter-rouge">CommandsHelper[F]</code> there. So far we have been working with the main commands helper, the client object. The client object uses the command settings we passed to it when building the client. We can also make other <code class="highlighter-rouge">CommandsHelper[F]</code>. Let’s see how, in addition to see how raw commands are done.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nc">TestCommands</span> <span class="k">=</span> <span class="s">"?"</span>
<span class="nc">TestCommands</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">?</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="n">registerRawCommand</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="kt">:</span> <span class="kt">Monad:</span> <span class="kt">Streamable</span><span class="o">](</span><span class="n">client</span><span class="k">:</span> <span class="kt">DiscordClient</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="n">commands</span><span class="k">:</span> <span class="kt">CommandsHelper</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="n">commands</span><span class="o">.</span><span class="n">onRawCmd</span> <span class="o">{</span>
     <span class="o">|</span>     <span class="n">client</span><span class="o">.</span><span class="n">withCache</span><span class="o">[</span><span class="kt">SourceRequest</span>, <span class="kt">RawCmd</span><span class="o">[</span><span class="kt">F</span><span class="o">]]</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">c</span> <span class="k">=&gt;</span> <span class="o">{</span>
     <span class="o">|</span>         <span class="k">case</span> <span class="nc">RawCmd</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="nc">TestCommands</span><span class="o">,</span> <span class="s">"echo"</span><span class="o">,</span> <span class="n">args</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
     <span class="o">|</span>           <span class="k">import</span> <span class="nn">client.sourceRequesterRunner._</span>
     <span class="o">|</span>           <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>             <span class="n">channel</span> <span class="k">&lt;-</span> <span class="n">liftOptionT</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="n">tGuildChannel</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span>
     <span class="o">|</span>             <span class="k">_</span>       <span class="k">&lt;-</span> <span class="n">run</span><span class="o">(</span><span class="n">channel</span><span class="o">.</span><span class="n">sendMessage</span><span class="o">(</span><span class="n">s</span><span class="s">"ECHO: ${args.mkString("</span> <span class="s">")}"</span><span class="o">))</span>
     <span class="o">|</span>           <span class="o">}</span> <span class="k">yield</span> <span class="o">()</span>
     <span class="o">|</span>         <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">sourceRequesterRunner</span><span class="o">.</span><span class="n">unit</span>
     <span class="o">|</span>       <span class="o">}</span>
     <span class="o">|</span>     <span class="o">}</span>
     <span class="o">|</span>   <span class="o">}</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">registerRawCommand</span><span class="k">:</span> <span class="err">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="err">]</span><span class="o">(</span><span class="n">client</span><span class="k">:</span> <span class="kt">ackcord.DiscordClient</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="n">commands</span><span class="k">:</span> <span class="kt">ackcord.CommandsHelper</span><span class="o">[</span><span class="kt">F</span><span class="o">])(</span><span class="k">implicit</span> <span class="n">evidence$1</span><span class="k">:</span> <span class="kt">cats.Monad</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="k">implicit</span> <span class="n">evidence$2</span><span class="k">:</span> <span class="kt">ackcord.Streamable</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="nc">Unit</span>
</code></pre></div></div>

<p>Here we create the new commands helper. Note that <code class="highlighter-rouge">?</code> is the only valid prefix here. <code class="highlighter-rouge">!</code> would not be valid.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
     <span class="o">|</span>   <span class="k">val</span> <span class="o">(</span><span class="n">shutdown</span><span class="o">,</span> <span class="n">newHelper</span><span class="o">)</span> <span class="k">=</span> <span class="n">client</span><span class="o">.</span><span class="n">newCommandsHelper</span><span class="o">(</span><span class="nc">CommandSettings</span><span class="o">(</span><span class="n">prefixes</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="nc">TestCommands</span><span class="o">),</span> <span class="n">needsMention</span> <span class="k">=</span> <span class="kc">true</span><span class="o">))</span>
     <span class="o">|</span>   <span class="n">registerRawCommand</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="n">newHelper</span><span class="o">)</span>
     <span class="o">|</span> <span class="o">}</span>
</code></pre></div></div>

<h2 id="access-to-the-low-level-api">Access to the low level API</h2>
<p>Accessing the low level API from the high level commands API is as simple as getting the <code class="highlighter-rouge">Commands[F]</code> instance that is backing the <code class="highlighter-rouge">CommandsHelper[F]</code> instance is as simple as calling the <code class="highlighter-rouge">commands</code> method on a <code class="highlighter-rouge">CommandsHelper[F]</code>.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">futureClient</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">client</span> <span class="k">=&gt;</span>
     <span class="o">|</span>   <span class="k">val</span> <span class="n">commands</span><span class="k">:</span> <span class="kt">Commands</span><span class="o">[</span><span class="kt">Id</span><span class="o">]</span> <span class="k">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commands</span>
     <span class="o">|</span> <span class="o">}</span>
</code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/js/main.js"></script></body></html>